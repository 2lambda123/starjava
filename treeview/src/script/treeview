#!/bin/sh

#  Find where this script is located.

if test -z "$TREEVIEW_DIR"; then
   TREEVIEW_DIR=`dirname $0`
fi
starjava_bin_dir="${TREEVIEW_DIR}"
starjava_dir="$starjava_bin_dir/.."

#  Locate referenced server dirs.

if test -z "$SPLAT_DIR"; then
   SPLAT_DIR="$starjava_bin_dir/splat"
   export SPLAT_DIR
fi
if test -z "$SOG_DIR"; then
   SOG_DIR="$starjava_bin_dir/sog"
   export SOG_DIR
fi

#  Locate the application jar file.  This is relative to this script.

appjar="$starjava_dir/lib/treeview/treeview.jar"
if test ! -f "$appjar"; then
   echo "Failed to locate the TREEVIEW jar file.  Please define TREEVIEW_DIR"
fi

#  Locate the java startup script.

starjava="$starjava_bin_dir/starjava"
if test ! -f "$starjava"; then
   echo "Failed to locate the 'starjava' script.  Trying with java on path"
   starjava="java"
fi

#  Locate demo data.

demodir="$starjava_dir/etc/treeview/demo"

#  Make sure that we get the installed shareable libraries.
if test -z "$LD_LIBRARY_PATH"; then
   LD_LIBRARY_PATH="$starjava_dir/lib"
else
   LD_LIBRARY_PATH="$starjava_dir/lib:${LD_LIBRARY_PATH}"
fi
export LD_LIBRARY_PATH

#  Run Treeview.

$starjava \
   -Duk.ac.starlink.treeview.cmdname="treeview" \
   -Duk.ac.starlink.treeview.demodir="$demodir" \
   -Duk.ac.starlink.treeview.sogdir="$SOG_DIR" \
   -Duk.ac.starlink.treeview.splatdir="$SPLAT_DIR" \
   -enableassertions \
   -jar $appjar $*
  
