<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta6 (August 14th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The polynomial fitting window</TITLE>
<META NAME="description" CONTENT="The polynomial fitting window">
<META NAME="keywords" CONTENT="sun243">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="sun243.css">
<LINK REL="next" HREF="node34.html">
<LINK REL="previous" HREF="node32.html">
<LINK REL="up" HREF="node7.html">
<LINK REL="next" HREF="node34.html">
</HEAD>
<BODY >
<BR> <HR>
<A NAME="tex2html449"
 HREF="node34.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html447"
 HREF="node7.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html441"
 HREF="node32.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>   <A HREF="sun243.html#stardoccontents"><IMG
 WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0"
 SRC="contents_motif.gif"
 ALT="104"></A>
<BR>
<B> Next:</B> <A NAME="tex2html450"
 HREF="node34.html">The generate spectra from interpolated lines window</A>
<BR>
<B>Up:</B> <A NAME="tex2html448"
 HREF="node7.html">Help for individual windows</A>
<BR>
<B> Previous:</B> <A NAME="tex2html442"
 HREF="node32.html">The region extraction window</A>
<BR> <HR> <P>

<!--End of Navigation Panel-->

<H2><A NAME="SECTION000413000000000000000">
The polynomial fitting window</A>
</H2>

<P>
The polynomial fitting window allows you to fit a polynomial of selected
degree to various selected ranges of the current spectrum. You can select to
use errors as weights for the fit and can save the fits on the global list as
spectra in their own right. Fitting a polynomial is generally a pre-requisite
to fitting spectral lines.

<P>
<DIV ALIGN="CENTER">
 <IMG
 WIDTH="397" HEIGHT="333" ALIGN="BOTTOM" BORDER="0"
 SRC="polynomialfitwindow.gif"
 ALT="2628">
 
</DIV>

<P>
The <B>Degree of polynomial</B> drop-down list shows a series
possible values for the degree of the polynomial that will be
fitted. Obviously this should be chosen to match the expected
complexity of the background.

<P>
The <B>Use errors as weights</B> checkbox is only effective if
the spectrum being fitted has data errors.

<P>
The <B>Subtract fit from spectrum</B> series of radio buttons
allows you to ask for the creation of a spectrum that is the difference
between the spectrum and the polynomial fit. Use the <B>As a
ceiling</B> option for absorption lines, and <B>As base line</B> for
emission lines. These subtracted spectra appear on the global list and
are added to the plot for display.

<P>
The <B>Divide spectrum by fit</B> checkbox allows you to ask for
the creation of a new spectrum that is the result of dividing the
spectrum by the polynomial fit. You will probably want to do this
before attempting to fit absorption lines so that the continuum is
normalized. The new spectrum appears on the global list (with the
name <TT>Ratio: &lt;spectrum name&gt; by &lt;polynomial name&gt;</TT> and can
plotted in a new window before fitting the lines.

<P>
<B><FONT SIZE="+1">Coordinate ranges</FONT></B>
<BLOCKQUOTE>
 This part of the window is used to define the regions of the spectra
 that you want to fit the polynomial to.

<P>
To add a region press the <B>Add</B> button and then drag out a
 region in the display area of the plot window. This should result in
 the creation of a green rectangular figure.

<P>
You can interact with the figure, moving it side-to-side and resizing
 it. To do this point at the figure and press the left mouse
 button. This `selects' the figure and adds <TT>grips</TT> to its
 exterior. Note that it also becomes the selected row in the
 <B>Coordinate ranges:</B> table. To move the figure just drag it
 and to resize it drag a grip (the little black squares). The
 associated coordinate range in the table updates with these changes.

<P>
To add a second range just press <B>Add</B> and repeat. The
 ranges can be overlapped or not.

<P>
To fine tune the ranges you can edit the values in the ranges table,
 just point at the cell you want to change and double click the left
 mouse button. This should enable the text editing cursor. Just make
 the modifications you want and press <TT>&lt;Return&gt;</TT> to make the
 changes permanent. (Note: if your spectra have sky coordinates shown
 for the X axis, then you should use the same format for your edits).

<P>
To read a set of ranges from a disk file choose the
 <B>File-&gt;Read ranges</B> menu item. The format of the input file
 is simple. It should have two fields separated by whitespace or
 commas. Comments are indicated by lines starting with a hash (#)
 and are ignored. You can also save the ranges to disk
 (<B>File-&gt;Save ranges</B>).

<P>
When you've got the ranges that you want to fit, press the
 <B>Fit</B> button. This creates a new spectrum on the global
 list, called <TT>Polynomial Fit: &lt;n&gt;</TT> and displays it in the
 plot.  You can save this to disk, or display in another plot <I>etc.</I>,
 just like any other spectrum. To just fit one or a subset of the
 ranges select the rows and then press the <B>Fit selected</B>
 button.

<P>
To clear any fits created by this window press the <B>Delete
 fits</B> button. To clear the ranges from the display area and delete the
 fits press the <B>Reset</B> button. To keep any fits just close
 the window.
</BLOCKQUOTE>

<P>
<B><FONT SIZE="+1">Fit status</FONT></B>
<BLOCKQUOTE>
 The <B>Fit status</B> text area shows some facts and figures about
 the fitting process. The <TT>RMS</TT> value is the root mean square
 difference between the fit and the spectra data <I>i.e.</I>:
 <BR><P></P>
<DIV ALIGN="CENTER">

<!-- MATH
 \begin{displaymath}
\displaystyle\sqrt{
    \displaystyle\frac{
       \displaystyle\sum_{i=1}^{N}((s_{i}-f_{i})*(s_{i}-f_{i}))}{N}}
\end{displaymath}
 -->


<IMG
 WIDTH="179" HEIGHT="79" BORDER="0"
 SRC="img3.gif"
 ALT="\begin{displaymath}
\displaystyle\sqrt{
\displaystyle\frac{
\displaystyle\sum_{i=1}^{N}((s_{i}-f_{i})*(s_{i}-f_{i}))}{N}}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
Where <I>s</I><SUB><I>i</I></SUB> and <I>f</I><SUB><I>i</I></SUB> are the data values of the spectrum and the
 fit (possibly interchanged) and <I>N</I> the number of positions in the
 spectrum.
</BLOCKQUOTE>

<P>
<B><FONT SIZE="+1">Command Buttons</FONT></B>

<P>

<UL><LI><B>Fit</B> Performs a fit on all the regions you've defined and displays
the fit and any subtracted or divided spectra in the plot.

<P>

<LI><B>Fit (Replace)</B> Same as <B>Fit</B>, except that if you've
opted to subtract or divide the fit into the displayed spectrum, then that
spectrum will be removed and you'll only see the subtracted and/or divided
result. If you haven't opted to subtract or divide then the results are
exactly the same as for <B>Fit</B>.

<P>

<LI><B>Fit selected</B> Performs a fit on only the currently selected
regions. The results are displayed in the way as the <B>Fit</B> command.

<P>

<LI><B>Fit selected (Replace)</B> Same as <B>Fit (Replace)</B>,
except only the selected regions are used for fitting.

<P>

<LI><B>Reset</B> Removes all fit spectra (from the plot and global list)
and erases the ranges. The polynomial degree is set to the default (which will
be the last value used in any polynomial toolbox).

<P>

<LI><B>Reset (Replace)</B> Also removes all fit spectra, but keeps the
ranges and replaces the spectrum first removed by a <B>Fit (Replace)</B>.
Effectively undoes a <B>Fit (Replace)</B>.

<P>

</UL>

<P>
<B><FONT SIZE="+1">Accelerator keys</FONT></B>

<P>

<UL><LI><B>Control-f</B> Do fit to all ranges.

<LI><B>Control-l</B> Do fit to all ranges, only display any new spectra.

<LI><B>Control-s</B> Do fit to selected ranges.

<LI><B>Control-t</B> Do fit to selected ranges, only display any new spectra.

<LI><B>Control-p</B> Reset interface after a fit replace.

<LI><B>Control-r</B> Reset interface clearing all ranges and new spectra.

<LI><B>Control-i</B> Delete any new spectra (fits and corrected spectra).

<P>

<LI><B>Control-d</B> Add a coordinate range (interactive or non-interactive).

<LI><B>Control-e</B> Delete the selected coordinate ranges.

<LI><B>Control-w</B> Close the window.

<LI><B>F1</B> Display help on <I>SPLAT-VO</I>.     

<LI><B>Shift-F1</B> Display help on window.

</UL>

<P>

<BR> <HR>
<A NAME="tex2html449"
 HREF="node34.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html447"
 HREF="node7.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html441"
 HREF="node32.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>   <A HREF="sun243.html#stardoccontents"><IMG
 WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0"
 SRC="contents_motif.gif"
 ALT="104"></A>
<BR>
<B> Next:</B> <A NAME="tex2html450"
 HREF="node34.html">The generate spectra from interpolated lines window</A>
<BR>
<B>Up:</B> <A NAME="tex2html448"
 HREF="node7.html">Help for individual windows</A>
<BR>
<B> Previous:</B> <A NAME="tex2html442"
 HREF="node32.html">The region extraction window</A>
<BR> <HR> <P>

<!--End of Navigation Panel-->
<ADDRESS>
<I>SPLAT-VO -- A VO-enabled Spectral Analysis Tool<BR>Starlink User Note 243<BR>Peter W. Draper & Mark Taylor<BR>13 November 2006<BR>E-mail:<A HREF="mailto:splat@star.rl.ac.uk">splat@star.rl.ac.uk</A><BR><BR>Copyright (C) 2001-2005 Council for the Central Laboratory of the Research Councils<br>Copyright (C) 2006 Particle Physics and Astronomy Research Council<BR></I>
</ADDRESS>
</BODY>
</HTML>
